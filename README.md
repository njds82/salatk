# Salatk (ุตูุงุชู) ๐

**Salatk** ูู ุชุทุจูู ููุจ ูุชูุงูู ููุตูู ููุณุงุนุฏุชู ุนูู ุงูุงูุชุฒุงู ุจุงูุตููุงุช ุงูุฎูุณุ ุชุชุจุน ุงูุตููุงุช ุงููุงุฆุชุฉ (ุงููุถุงุก)ุ ูุจูุงุก ุนุงุฏุงุช ุนุจุงุฏูุฉ ูุณุชุฏุงูุฉ ูู ุฎูุงู ูุธุงู ุชุญููุฒู (Gamification).

---

## ๐ ุงูููุฑุณ (Table of Contents)
1. [ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุดุฑูุน](#ูุธุฑุฉ-ุนุงูุฉ-ุนูู-ุงููุดุฑูุน)
2. [ูููู ุงููุดุฑูุน (Structure)](#ูููู-ุงููุดุฑูุน)
3. [ุฏููู ุงูุจุฑูุฌูุงุช (Module Documentation)](#ุฏููู-ุงูุจุฑูุฌูุงุช)
    - [ุงููุฏูุฑูู (Managers)](#ุงููุฏูุฑูู-managers)
    - [ุงูุฎุฏูุงุช (Services)](#ุงูุฎุฏูุงุช-services)
    - [ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ (Helpers)](#ุงูุฃุฏูุงุช-ุงููุณุงุนุฏุฉ-helpers)
4. [ุฏููู ุงูุตูุญุงุช (Page Reference)](#ุฏููู-ุงูุตูุญุงุช)
5. [ูุงุนุฏุฉ ุงูุจูุงูุงุช (Database Schema)](#ูุงุนุฏุฉ-ุงูุจูุงูุงุช)
6. [ูุณุงุฑุงุช ุงูุนูู (Workflows)](#ูุณุงุฑุงุช-ุงูุนูู)
7. [ุงูุชูุตูุจ ูุงูุชุดุบูู (Setup)](#ุงูุชูุตูุจ-ูุงูุชุดุบูู)

---

## ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุดุฑูุน
ูุนุชูุฏ ุงูุชุทุจูู ุนูู ููุณูุฉ "ุงูุณุญุงุจูุฉ ุฃููุงู" (Cloud-Only)ุ ุญูุซ ูุชู ุชุฎุฒูู ูุงูุฉ ุงูุจูุงูุงุช ููุฒุงููุชูุง ูุญุธูุงู ุจุงุณุชุฎุฏุงู **Supabase**. ูุชููุฒ ุงูุชุทุจูู ุจูุงุฌูุฉ ูุณุชุฎุฏู ุนุตุฑูุฉ ุชุฏุนู ุงููุถุนูู ุงููุงุชุญ ูุงูุฏุงููุ ูุชุนุฏุฏ ุงููุบุงุช (ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ).

---

## ๐ ูููู ุงููุดุฑูุน
```text
salatk/
โโโ assets/             # ุงูุตูุฑ ูุงูุฃููููุงุช ูุงููููุงุช ุงูุซุงุจุชุฉ
โโโ components/         # ููููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู (Cards, Modals)
โโโ js/                 # ุงูููุทู ุงูุจุฑูุฌู ุงูุฃุณุงุณู
โ   โโโ pages/          # ููุทู ุงูุตูุญุงุช (Home, Store, Leaderboard...)
โ   โโโ services/       # ููุทู ุงูุนูู (Business Logic) ูุงูุชุนุงูู ูุน ุงูุจูุงูุงุช
โ   โโโ i18n.js         # ูุธุงู ุงูุชุฑุฌูุฉ ูุงููุบุงุช
โ   โโโ auth-manager.js # ุฅุฏุงุฑุฉ ุงููุตุงุฏูุฉ ูุงูููู ุงูุดุฎุตู
โ   โโโ prayer-manager.js # ุญุณุงุจ ุฃููุงุช ุงูุตูุงุฉ ูุฅุฏุงุฑุฉ ุงููููุน
โ   โโโ sync-manager.js  # ุงููุฒุงููุฉ ุงููุญุธูุฉ ูุน ุงูุณุญุงุจ
โ   โโโ app.js          # ุงููุชุญูู ุงูุฑุฆูุณู ูู ุงูุชุทุจูู
โโโ styles.css          # ูุธุงู ุงูุชุตููู ูุงูุฃููุงู (CSS Variables)
```

---

## ๐ ุฏููู ุงูุจุฑูุฌูุงุช (Module Documentation)

### ๐ ุงููุฏูุฑูู (Managers)

#### 1. `AuthManager` (`js/auth-manager.js`)
ุงููุณุคูู ุนู ุชุณุฌูู ุงูุฏุฎูู ูุฅุฏุงุฑุฉ ุงูุฌูุณุงุช.
- **ุงูุฏูุงู ุงูุฃุณุงุณูุฉ**:
    - `signUp(username, password, fullName)`: ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ.
    - `signIn(username, password)`: ุชุณุฌูู ุงูุฏุฎูู.
    - `getSession()`: ุฌูุจ ุงูุฌูุณุฉ ุงูุญุงููุฉ ูุน ูุนุงูุฌุฉ ุงูููุช ุงููุณุชูุทุน (Timeout).
    - `getProfile()`: ุฌูุจ ุจูุงูุงุช ุงูููู ุงูุดุฎุตู.

#### 2. `PrayerManager` (`js/prayer-manager.js`)
ุงููุณุคูู ุนู ุญุณุงุจ ุงูููุงููุช ุจุงุณุชุฎุฏุงู ููุชุจุฉ `Adhan.js`.
- **ุงููุชุบูุฑุงุช ุงููุงูุฉ**:
    - `cachedTimes`: ูุชุฎุฒูู ุฃููุงุช ุงูุตูุงุฉ ููููู ุงูุญุงูู ูุชุฌูุจ ุฅุนุงุฏุฉ ุงูุญุณุงุจ.
- **ุงูุฏูุงู ุงูุฃุณุงุณูุฉ**:
    - `calculatePrayerTimes(lat, long)`: ุญุณุงุจ ุฃููุงุช ุงูุตููุงุช ุงูุณุช (ุจูุง ูููุง ุงูุถุญู).
    - `checkAndMarkMissedPrayers()`: ูุญุต ุชููุงุฆู ููุตููุงุช ุงูุชู ุงูุชูู ููุชูุง ููู ุชูุคุฏู ูุฅุถุงูุชูุง ูููุถุงุก.

#### 3. `NotificationManager` (`js/notification-manager.js`)
ุฅุฏุงุฑุฉ ุงูุฅุดุนุงุฑุงุช ูุชูุจููุงุช ุงูุฃุฐุงู.
- **ุงูุฏูุงู ุงูุฃุณุงุณูุฉ**:
    - `scheduleNextPrayer(prayerTimes)`: ุฌุฏููุฉ ุฅุดุนุงุฑ ููุตูุงุฉ ุงููุงุฏูุฉ ููุฑุงู.
    - `showNotification(prayerKey)`: ุฅุธูุงุฑ ุงูุชูุจูู ูููุณุชุฎุฏู (ูุฏุนู Service Worker).

---

### ๐ผ ุงูุฎุฏูุงุช (Services)

#### 1. `PrayerService` (`js/services/prayer-service.js`)
ุงูุชุนุงูู ูุน ุณุฌูุงุช ุงูุตูุงุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
- **ุงูุฏูุงู ุงูุฃุณุงุณูุฉ**:
    - `markPrayer(key, date, status)`: ุชุณุฌูู ุตูุงุฉ ูู "ุชูุช" ุฃู "ูุงุชุช".
    - `addQada(date, key, rakaat)`: ุฅุถุงูุฉ ุตูุงุฉ ููุงุฆูุฉ ุงููุถุงุก.
    - `getPrayerStreak()`: ุญุณุงุจ ุณูุณูุฉ ุฃูุงู ุงูุงูุชุฒุงู ุงููุชุชุงููุฉ.

#### 2. `PointsService` (`js/services/points-service.js`)
ุฅุฏุงุฑุฉ ููุงุท ุงููุณุชุฎุฏู (Gamification).
- **ุงูุฏูุงู ุงูุฃุณุงุณูุฉ**:
    - `addPoints(amount, reason, id)`: ุฅุถุงูุฉ ุฃู ุฎุตู ููุงุท (ูุน ููุน ุงูุชูุฑุงุฑ ุจุงุณุชุฎุฏุงู `id`).
    - `getTotal()`: ุฌูุจ ุฅุฌูุงูู ุงูููุงุท ูู View ุฎุงุต ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

#### 3. `SettingsService` (`js/services/settings-service.js`)
ุฅุฏุงุฑุฉ ุฅุนุฏุงุฏุงุช ุงููุณุชุฎุฏู (ุงููุบุฉุ ุงูุซููุ ุทุฑููุฉ ุงูุญุณุงุจ).
- **ุงูุฏูุงู ุงูุฃุณุงุณูุฉ**:
    - `set(key, value)`: ุญูุธ ุงูุฅุนุฏุงุฏ ูู Supabase ู LocalStorage.
    - `applySettings(settings)`: ุชุทุจูู ุงูุฅุนุฏุงุฏุงุช ุจุฑูุฌูุงู ุนูู ูุงุฌูุฉ ุงูุชุทุจูู.

---

### ๐งฐ ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ (Helpers)

- **`ui-helpers.js`**: ูุญุชูู ุนูู `updatePrayerCard` ูุชุญุฏูุซ ุญุงูุฉ ุงููุฑุช ุฏูู ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉุ ูุฏุงูุฉ `withTimeout` ูุถูุงู ุงุณุชุฌุงุจุฉ ุงูุชุทุจูู ุนูุฏ ุจุทุก ุงูุดุจูุฉ.
- **`date-utils.js`**: ูุญุชูู ุนูู `getHijriDate` ูุญุณุงุจ ุงูุชุงุฑูุฎ ุงููุฌุฑู ุจุฏูุฉุ ู `formatDate` ููุชุนุงูู ูุน ุงูุชูุงุฑูุฎ.
- **`points-manager.js`**: ูุญุชูู ุนูู ูุตูููุฉ `RANKS` ุงูุชู ุชุญุฏุฏ ุงูุฑุชุจ ุงูุจุฑููุฒูุฉ ูุงูุฐูุจูุฉ ูุบูุฑูุง ุจูุงุกู ุนูู ุงูููุงุท.

---

## ๐ ุฏููู ุงูุตูุญุงุช (Page Reference)

ูู ุตูุญุฉ ููุง ุฏุงูุฉ `render...Page()` ุชููู ุจุชูููุฏ HTML ุงูุฎุงุต ุจูุง:
1.  **Daily Prayers**: ุชุนุฑุถ ููุงููุช ุงูุตูุงุฉ ููููู ุงููุฎุชุงุฑ ูุชุณูุญ ุจุชุณุฌูู ุงูุฃุฏุงุก.
2.  **Qada Prayers**: ุชุนุฑุถ ูุงุฆูุฉ ุงูุตููุงุช ุงููุงุฆุชุฉ ูุชุณูุญ ุจุฃุฏุงุฆูุง (Make up).
3.  **Habits**: ุชุชุจุน ุงูุนุงุฏุงุช (ุนุจุงุฏุงุช ุฃู ุงุจุชุนุงุฏ ุนู ุงููุนุงุตู).
4.  **Store**: ูุชุฌุฑ ุงูุซููุงุช (Emerald, Midnight Blue) ุงูุชู ุชูุดุชุฑู ุจุงูููุงุท.
5.  **Challenge**: ูุธุงู ุฃุณุฆูุฉ ูุชุญุฏูุงุช ูุงุฎุชุจุงุฑ ูุนูููุงุช ุงููุณุชุฎุฏู.
6.  **Leaderboard**: ููุญุฉ ุงูุตุฏุงุฑุฉ ุงูุนุงูููุฉ ุจูู ุงููุณุชุฎุฏููู.

---

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Database Schema)

### ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ:
- **`profiles`**: ุจูุงูุงุช ุงููุณุชุฎุฏู (ุงูุงุณูุ ุงุณู ุงููุณุชุฎุฏูุ ููุฏ ุงูุฅุญุงูุฉ).
- **`prayer_records`**: ุณุฌู ุฃุฏุงุก ุงูุตููุงุช ุงููููู.
- **`qada_prayers`**: ุณุฌู ุงูุตููุงุช ุงููุงุฆุชุฉ ุงููุฑุฏู.
- **`habits`**: ุชุนุฑูู ุงูุนุงุฏุงุช ููู ูุณุชุฎุฏู.
- **`points_history`**: ุณุฌู ุงูุนูููุงุช ุนูู ุงูููุงุท.
- **`owned_themes`**: ุชุชุจุน ุงูุซููุงุช ุงูุชู ุงุดุชุฑุงูุง ุงููุณุชุฎุฏู ูู ุงููุชุฌุฑ.

---

## ๐ ูุณุงุฑุงุช ุงูุนูู (Workflows)

### 1. ุงูุชููุฆุฉ (Initialization):
ุนูุฏ ูุชุญ ุงูุชุทุจููุ ูุชู ุชูููุฐ `checkAuthAndInit` ุงูุชู:
- ุชุชุฃูุฏ ูู ูุฌูุฏ ุฌูุณุฉ (Session).
- ุชุฌูุจ ุงูุฅุนุฏุงุฏุงุช ูุงููููุน ุงูุฌุบุฑุงูู.
- ุชุญุณุจ ุฃููุงุช ุงูุตูุงุฉ ูุชุฌุฏูู ุงูุฅุดุนุงุฑุงุช.

### 2. ุฏูุฑุฉ ุญูุงุฉ ุงูุตูุงุฉ (Prayer Life-cycle):
- ูุญูู ููุช ุงูุตูุงุฉ -> ูุธูุฑ ุฅุดุนุงุฑ.
- ุงููุณุชุฎุฏู ูุถุบุท "ุชู" -> ุชุถุงู ููุงุท -> ูุชู ุชุญุฏูุซ ูุฑุช ุงูุตูุงุฉ ุงูุณุญุงุจู.
- ุงูุชูู ููุช ุงูุตูุงุฉ ููู ูุถุบุท ุงููุณุชุฎุฏู -> ุชูุถุงู ุขููุงู ุฅูู ูุงุฆูุฉ ุงููุถุงุก.

---

## ๐ ุงูุชูุตูุจ ูุงูุชุดุบูู
1. ูู ุจุชุซุจูุช ูููุงุช ุงููุดุฑูุน.
2. ุชุฃูุฏ ูู ุฅุนุฏุงุฏ ููู `js/supabaseClient.js` ุจุจูุงูุงุช ูุดุฑูุนู ูู Supabase.
3. ูู ุจุชุดุบูู ุฎุงุฏู ูุญูู (ูุซู Live Server).
4. ุชุฃูุฏ ูู ุชูุนูู RLS (Row Level Security) ูู Supabase ูุถูุงู ุฃูุงู ุงูุจูุงูุงุช.

---

**Salatk** - ูุณุฃู ุงููู ุฃู ูุชูุจู ููุง ููููู ุตุงูุญ ุงูุฃุนูุงู.
